(def sample-input "AxBCDDCAxD")
(def potion-costs {\x -1 \A (inc 0) \B (inc 1) \C (inc 3) \D (inc 5)})
(defn potion-cost [input]
  (reduce + (map potion-costs input)))

(def actual-input
  (->> "CADAAADBAAxBBBBDCAAACDBAABDABxACDBBBDABCABBCAxACxBBBxBxCxDDABCAxDCADxCBADBABCCADDBBBDCBCABADxDBAACABDBCBDDBBDCABxDBCDCAACCxBACAAACxBAAxxxCAACCABADACBABxACAADBADDxBDBCAABADxABDDxBDDBxDDxDxDADADDADADAxDDDBDADDCBCACADACADxDDDBABACABDDDBBCBDxBCABCxCxBxACDCxAxAxABDACxCBCCBxxDDCBBADBBABCBAABCBBBDBBBBBDxCCxDCCDAACACxDxxxCAADAAADAAACAxBCAxBABBxDBCCABADCCCBAAADCAxBAADDABCxBCDxABDBAAxDAAAxxABCDBBCDCBCACCBCCxxAxACAxDDBABABAAABBAxCBDDxDDDDBCxBACCxADBBDDBDBADBABDADABDDCBDDAxBBABACDABDCBBDCBxBBDDxxCCBAACDBDDCCDDACACCDAAAABxDDAxCAAACBACBDxxCCCCACCAACAxAxDBxCDBCCAxBABABCBDBBBxDCCAxxACBCCCDCDBCDxBAADxBCCDAABBCDCxxBABBBDADCCDCCCBABDxAxCBADBBACAxDxCBBCDAxBxBBDADCAxABBDxACDADBDBDxDCBCBCCADCCCAABBxADCABDDDCDCDAAxCxxBABAxCCBBBAxxCACACDCCACDCAxBABDAxDCBAACACAxABCCxCBADxCAxxCCDxAABDDBDxxBCBDDDDBAAxABAxDCBBAACDADABCAAAxCDDDDBAABBBAxCABCCBACxDADDAABBBBACABCBDDBDxAADxCACBDCADAABCBBBDBCADDxABCxAAAxBABBDxxACACDBBxCABCDDxABBBBxDCCDBCBBAABBDACCCDBACDCCDDCDBCCCDxCDBCDBDACDCBBBADxDBCDCBDCAxBCBDBDACDAAACBCDDxBDADDDBDADxxACAxBACDDBBABABADABBDDCCDCDABADADCDDBACBCCDxCCDCBxBCABDADCADxBBAxCDxCDCABBAAACDBADCAADBDDBxBBDCDACDBCDAACCCBBAxADBCxCBCBDDBBCBABCCBBDBCxCCxBCACBBAAADBBBAxxBCBBDCBCDABBDAAxBBADDDDBBACAxxCBDxBBDCCBBxBDDACDADBDxBBCDDCCCAACACACxDCAACDCxCDBAADBBCAACBABBCxDACDBADxBACCCCABCCCxCxxCxCCCDCBxCCDABCCCCCxxCACxCADAxBDxBCAADAACCDBCBCCBACCDACCADDCBCBAABxxDBDDCBBBAxCADADBABACAAABDxCDDBBCBAADBCCCBCDBACxBCxDAADAADCADxACBAxBDADDABBBxBCADDABDBADxBBDBDDDABxADxBACxDAAAAAABCBCDDCBCBBCBBDxBDDACADABCCABBCCDBACCDCABCBDBBACADDCxACDACCBCBCCBBCCABBxAAACADBDCDDCABABAxCDABxxADAAAxAxCABBCCBDDBDBBCBCCBCABAAADACCBBACDBACDCABADDxDDACADBDBBCAAADDDDDBxADDCBCBCDABBDDxBCBBDACBCxCxCCAAACBBxCxCCDCDCDDBABDBBAADDDABBBAxBBDCCACDDxDACBABBDBDABBADABxBACADBCBDBCCxACCxBADAAACBACBABxDBxCDxCCBxxAADBACABDDDACDDAADDCCxAACCBBDCBCBBCCCBBxBDxxDAACAxDCADADCxDCCCxxBDDDBCBDDxDCABDDCBCBBxCCBACDBDxCBDDxxCAADxBxABCDDABDBDABxABBBBxDxxAxCCDCCDDxCBBBxDDBDBCDCBACCxxABACDBBAxCDCDBBDxCCCxDABxBBCCDAxAxDDBBAABCBADxAABDACCBDBDxAADDCDDAxCAADDABCDBxCACDAA"
    (partition 2)
    (remove #(= % '(\x \x))) ; remove double-x pairs
    (apply concat)
    (apply str)))

(println 0    (potion-cost "Ax"))
(println 6    (potion-cost "BC"))
(println 12   (potion-cost "DD"))
(println 5    (potion-cost "CA"))
(println 5    (potion-cost "xD"))

(println 28   (potion-cost sample-input))
(println 5435 (potion-cost actual-input))
