(def sample-input "xBxAAABCDxCC")
(def potion-costs {\A 0 \B 1 \C 3 \D 5})
(defn clean-group [group] (remove #(= % \x) group))
(defn solo-cost [solo] (reduce + (map potion-costs solo)))
(defn duo-cost [duo] (+ 2 (solo-cost duo)))
(defn trio-cost [trio] (+ 6 (solo-cost trio)))
(defn group-cost [group]
  (case (count group)
    1 (solo-cost group)
    2 (duo-cost group)
    3 (trio-cost group)
    0))
(defn potion-cost [input]
  (->> input (partition 3) (map clean-group) (map group-cost) (reduce +)))

(def actual-input "CABDDBBCDCCCxBCBDxCBxACAAxxCBCDxCACAxBxAxxBBxCDAADAxxDCCCDCCBAABxAxDDCCxABxBxCAxCCDADCABxxDxCAAxACDDCCDAACDCBAxxxDADCACBDABDBCCCCBDCxDBBBDBBDDxBBBxDBDCCxxDADCBADxxxBDxxAxxCDCCCxCxxCxxCDDAxDABDxCDBCxxACCDADBBxBDAAxxCDACBxCBAAABBBBBBDCAAxDxCCABBDBACxACCBCCDAAxxDxxxACxBxCxxAxxCxAxDxCxxDCxBxBxDxBAADCxCxxBDDCDCxCCBCBACCxACCBBBAAADxDABDDDDCBABxxDADABDBDBAxCxADDADAxAxDABxBBCCxxCDxBxDCCAxACCDDADAABBDAxBxDAAAAxAxAACABBDDxABCxDxDBxADBCDxxAxxDBCCxDBBxBDBAAxBDDxBCDxCxBDxBAACCBBCCDCxCDxCABxxACxDxDBAAADBBBCCBBDCDDDBBDBxBBCCCAxCBCDBBCAxABAxABCBBBDxBxBxADCxBABDCxCACDxBxAxDABABABxCCAxDAACDBCAxAADDADxCBBCCxACADBDADCDABAxDDACCBAADxCAADCDCDDABxDAACCCDBACxBADCDDADCxDDCBDABCCADACxAxACCDAAACDBCDACDxBADACBxCAADDBDCCCCAxCDACDDCxACBxBBACBDxCCDDxACAABBxxxxDACxBxBBBCBDCBCADxCBBDxxBDCCDDCxxxAxDBxBxCBADDCBCxACDCDDCxCAxCxBADCBAADxAxDCADxDBBxCADBBDCCxBCADABCBCxCxDDBACDDBCDADxDBDCABxBDCDDBBBCDBAAAxxDDCDxABCDBxxBBxBAxAACCDDDxCDxDAAABDDABDDBBACDAxBxBCAxADDxCDACAAxBxBxDAxCBDxxCBxxBBCxBADCACxBBADxDCABxAAACAxBAxxxBACBxBAxCBDCDxCxBDxBBBCAxBDxDDCCDCAADxxxDxxCxACABACxABxCDACBxxADxCDCDCCAAACxCBBDCADBDDBxAABxDCDxADACxCxxABDBAxxBBDDxBBBxDxCCBABCDxxBBBBACBCBCxAABACAxDBBBACxBDBBCCCBxxDADAxABCAxxCDDDxDBABxDBBADxADxDAxADCCACCBxDDCDCBACCBCCBxDxCACAADBADAABCABxDxCCBADxACxCxAADCCACAACxCAxAxDAxCDDCxCDxxBADxACCCBxAACDCxxDAxCDACBBACAxxCxCxBAAxxDxxDxBABDxxCCCBCxCBADDBxxxDBxCDxBxxBBDCDDDADDxCABxxDABAAxDCCADxxxCCABBCBDxDDCCDxBDACDCDACDxDCxCCAxxDDDCAxBAxCDCCBxDBCBCBCDBACBBBCABDBDCABxDCAAxCCABDxADCCCABDBCxBCCCxDCxxxAACBDBxxBDDBACDxCAACDBBxCBADxCBBAxAAxCxBCCDBCxDxBxxDABBBABDADxCCBABAAxDCCDAxCxBAABAABABCxxxCAxADADACxCABBABAxxBBxAACCDCDxDCCBAAABCCABxxCBDxCCCCBAxADAxADCAACAAAxDDCABCxAABDBDBBCDBxACAABBABBBxBxDxCCCBAxCCDxCxxBBCBABxxBxCBDCDxBCDACACCxCBCDADDCCCDxAxBCADACDDBDAxDAACDDxxADDAACDDBCCBBACCDAxBxABDxCBAxCADxDDBDxxDADCxCAxDCDCBBDCCCxxBxDACAAxxBBAAxxCBDBBAxDBCCBDxDCDADBDxDDDxBDAACCADCBxxCBxADAABDADBCBDxCADxxABDBABxxAAADxxCBxAADxCxxxDxDBBCBxAABDADxCDxCCBABCDDxCBCBxADxADDAxCBBBADBADADxBAxCAABDADCxCxxCDxBBCBBABCBADCDxxBCBBxxDxxDDBADDDBDDDBAxDDAxCxBDxCxBxDDxDDBBxxADBCBxDDCCBxxCACBxBBDxxBDCADBxADADDACxCBxBCABxDxxAADCACBACACCxCDxAADCAACCADDCABDADBDBAxCxBxDBBDBDBBxDBAAABDCBAADDCBCBCxDACxxxDACBxBBDxBCCxADDDCBBBCCxABAABxAxxDDxDDxACxAAADxABBBDAxCACDBBDCxCxDBBBAAxBBAxxDBAABABBxxxxxABBxDCCCABBCAxAxCDxBDADBBBAAxCADACxDxBDBADBDDADxBBxDCDBCCBDCxxAABDxCDAADBBCAADCBADCxACDxxBBxAxAAxDxDDDxBACCCDxBBDxCDBACxxxAxCDDBxBDBxCxCDBCADBACBABACADCAxxCxCCDxxxCCxBDBCxDDAxxCACDxBxBAxBDxDBxAxCACxDACxDCCDDxDDCAxDxxBBAAxxAAxCDABDADAAxxDCxDCBAxDBxxACDBDBCDAxBxCDADDBxCDAxDDBxBDxCBxxABDACCACCDCADxBBADBxxxDDCxxACBBDCCBABxDAAAxABxCCCCDCDABCCDAxAxCAACCCCBBDACCxAACBxxDCxDBCxDDCCBCxACABBCBxCABDDxAABDCDBAAABBAAADACDxBAxCDDBCDBDDBABDDxDDxBxxDDCBACBxCBxBxCBBDxDBCCxAxBBDDDDBCBxCCBDDDCxxCCxDDxBDDAAxDACACAxAAAxCDABxxDDDAxCBBxDDBBACAAxDDBCxCCBxADADDxBxxCxBBAAxxCCBxADADBDCABxABBDDxDBCACBxBCCxADAxDBDDCCCxBBxxADAxDBDABADDCCAAxCCACxCBACDxCCDxDAACCxADBBDACAxDxACxxBBBDxDDADCDDADxABAACBAxxACxCBDABxDxAABABDxCBxxBADBAxADDDCCxBDCDAAABBDCBCCBDAxDABBBCCxCDDCBxxBDBCxxCxAACCDADxBBDAxDCAxDxABBCDxxCCCCxBBxDAxCxDDBCBCCDBBCBBDxACAxAxBAABBBDBCDDAADCCxxxADDBBACBDBACDxADABBDABxCADBCDxDBBCBCCxADDxBADBCDBCACCACCDDBxCAABxDBACCDBBCBDCCAABACADDCABDDABxDABBDDABCBBCABDBDABBDCBBBBxxxCCBBxADxCxxDCABBCCCDDDDADDxCCAAACAxBAxBBxDBBAxxADCACACxxDBAABBACABAxxBCDCxxCACBBACAAAxDBAADCBDxAAABxxCCCxxBDxxxCxDBCBxDCBBxxCBABACDADBDDxBCDABCBxBAxCAxACBDDCDCCCxBxAxDxCCxDADCBDBACDxBAxAxCDCxCxADDxxAACDDACBDBBAxDDCDAACDABCBCCAxDxCBCBxBxDBACAxACAACDAxDBDCBBCAACBDDDDBDxABxDDAxAAxDAAxCABBBBxxDCABDxCDBACDDBBACBCxACBxxxAACADBxBBxxxBDDDBCAAxCCCxDDAACDBDCxDxxxBDDADxABADxCDCBAAxCxBDBADCAAxxCACCCBCCAABABBxBBBxxxCDDxAxCBCAABCCDDAADAADABAADDBxCCAxBxxCBDxCDDBBxDCCDBAACBxAxCxAABDxxBxxxCADxBBACDxxDBCDAADDCDxBCCADAxCBBBBDxCDDAxDBDADDABxAAACDCACxxABAAAxBAAABACxBACDxDCCCBDDCCDABBBABCDDCxDADBDCxDADACCDxDCCBABxxACACAxCBBBAAxCCBCCxxDCCDxxBBxDDBCBxxBDBBBABDACDxCxxDDADABBxBBBBDxBCxxAAxBBCCAABADCCADBCxDDxAxABDCAADDxBDxCBBAxCxCBDDBCBDAACDACDACCDACBDDDDCDCAAAACDDxxDBxxCDDxCAAxAAABBxDBBADAADxxABDBxDCxxCBxDxCDBxBDABCDDDCAxAxDCxADDxxDADCCCDBDABDAACCDCCAxABDxDADDBxABBBxBBBBDBBxxxADAxDxBACCCAxAAxxCDxACBDCBAADBxDBABDCDADAxAAAADAxDACxCCBDCABBBBDxxBDDxDxBBABxABCCAADDBBDxACDxAxAAxDDCxDxxCABxACBACBACBCCDADDDxxxDBCxCCABxDBDBCDxxABAADCADDDDxDADCCCxDDDxxACDxACCBCDDADBxBxxCDACDxxBxAxACAxAAxxBDDxxCxBCBxBxCDxxCDBBCCxAADAxBBBCCDACBADCBxBDCDACAAxBABCCxDCDBADBBDxDDAAxxCAADDBxCBAxABABBxAADxCBCADDxxCACBCBCCABBDxCCCDxxAAAxDACxBCCBCCBBBxCCDCCADDAAxCBCxxCACBxBAxCBDCBBBABDDCAADACACDCCDxDABAxAxxCAxDCABBBDBCDxDxAxBxBCCxDBACADxADxxCABxBDxCAxCBCBACDADCBxACACxxCxCBDADDDACCBxBCDBABCDDDDBCxDxCDBxADCBxCxCCxxCxBBxDxCDCAABDDxACCxxxBCDDxBADxACCxCAABDxAxxBCDxDDDABBxABxxAxxADCxDBDBBACxCBxCDxxBxDxCCABBCABxACDDDCCCCDBBxBDDDDAACxDBCDDAAxCABAxxABBCCABBDDDACCAxBBCDDxDCBBCBCDAxDCxCABDCCCBCADDCBAAADDxCBADACxDBxxDDxDBCAxCCDABDCBxAACDxxxxCDBxBDDDBADADCDDDDBAxACCxxDADDACCDADAxCxBDxDCxBBAxCAxDACABBBADDBAxACxxACDxBACxAxBACACAxxxAxxDxCxxDDxCDDxCBxBDABBBBCCABBDCCADDCDBBADCDxBxACCBCDCDCADAxDADDAAxADxABBCxDBxAADCxxDCxBCBDBxBCDBBAAADCBCBDDBxxABCCDxAACDBCDCABCACBCCAxxDDDCAAxCDCBABDCAAAxBBxxDDCABACCDADBxBCBxACAADDBxBxBDxBABAxxCAAxBDACCBDBBxCDACCxxAACxADDBDxCDCACxDDxADCDCCCCBBBADCBDAxAABCACBCDBCBDBBBBCCxxCxDxBxxxBxCxDBBBAxxBxBBBCAxABxAxAxAxCAADDxAxxxAAADCCCAADCCCAAxCAADDAAxACCxDADBAACCBBDBCBDCDCxxDBAxDBCBCACDABBACCxCxBCDDABBACCAACAABCCBBDxBxDCBxCxDAxDBADBCCACBBDDDAACxBCABDCBxxxDxAACxxBCxCDABBDDADBACCxxCCxCCxxBxAxCxABCxCBCDCBDAACBDDBxxDCDDDCBxxCBAxBBDxBxxABDABAxBDBCCDDADDxACxDACACxxDDxACxABBxAxAAACxxACxDCxBCxxBxAxBBBDBDBCCBBDDDCAxCAABDxAAxxDxBCBDAAxxBCCxAxBCACDDCBxDCxBCDDBBACACBDBCDAABCxAAxAAxAxBCCxDADDxDAxxABxBACAxBBxCBBBBADxBDAADxxBBDADDDxACDDBDCABxAAxBCACxBBBADCAADxADBxCABACDBDDBDxCAxBBDBBAxCCADDDABCDBDxxxAxDCCBxxCAAAACBCABDAxADDBABABDBxxADxABxBBxDCDABDBDABDBxxBxxBDBxBxDDDCAAABAxxBCABBAxCCDABDDADBxACDDDCBAxxBDDxCCAAADCxABBBCDxBBBABDCCDCDBADDCCDDCxBAxxBBACACxAADxAxxCCCxABBxDADxAxABADDDxxDCCBxDAAAABDDDxCBBBCACCDxABxAxxDCBxDxxCCAxxCAxCDBCBCxBABxACCBADxBBDxxDBADxBxBACCBAACBADBBABCDACCDxxxCDCDxDBCAxxAxDCDDBBBBABCADAADCADxCDxxDxBBAABCxBDAxCDCDACAAxAxAAxAACxxAAxxCxCDBDABACDAxBBDDBBDxCDDCxCACDCDDBDBDABDCCxDDxCAAxAxDxDDCCCDBxCCDCBBBxCDACBDxBADACCDBxABCBBxBADBDDCDAADCBxDBDABCCBxBBCBBBxBDBDxBBDDxDxDDDDADDxDDABBBBCxCCAABACBAAxACBDADBABCAxCBDxDAxDCABxxAxAACCxBCBDxABADDxDxDBDDAABBCxDBDBADxDxACCxCAxxBBBADBBxCCCBBCBxxCADxDBABBADDxCCDDACABDxxCABDAAxCBCAAAxACxCAxCABBCDBDxDDBDCxDxDBCxxBCBCBDACCxxxBCBCBCxxxBDxxBDABxCCAxBBxBxCxxDAAADxBCACCAxxCDDBxDCBABDxBAAABxBCBBBDBBCDBBACCDBDxBAxxACxBxABCABDxxDCADxBDCBBCxCDCBAxABAABAAxDxxxxDCCxACDADBCBxCCxDCCxADCxxBxxDCADBBDDABCBABDCxxADBCBCDADDCCCBBDCDACBBxAACCBDADBDAACBCCxDAxDDCCxxCxADCCDCADxBCBCBDBBADBDDBABCxAxAxACxCABCCDDCCDAAxDCxBDBCBBxCDCAAxAxDDxADBDxDBBDABCxCxACxxBCDDDDDBAABBxBADAADBDACCABABADBCADxBAAxCCAACACCDCxBBDCCBBxCAAxCBACBDBAACBAxADDDDDCxBAxBCxDDxxxDACAxABBDxBBBCxxCACABDxBBDDACDADBDCADAADDBBDBAAxBDBBDCCDDxDCCDACCxDBAAAAxDCxADAAAxBCxDACDCADBCBBDxACBxCCAABADDAxACCDCDxDAAxxBxACDxAAAxBDxADBDCDDCACDABDCBBAAxBBxBCADBDBxBCDACBACAADBAABxxCBxDxDxxACACADAABBDCBCDBxADxDxADCxBCDBCCBAxCDBDDBDAxAAxABBxxADAAACCxCAxDAACBDDADBBAACDCBCACDCAxCCBBBCBxCBCDAxACADCxDxBDCCxBBCCAAxBxBCAxBCBDCBxCxAABxAxxCDDADDABxxBxAADCDxxBAAxAxACCCDxBACBDABBDADDDDABDxDABCAxBCDxCBDAxDxCxACCCAxDDxxxAxBAxBACDBxABBDBBCADDxBxBCCBCBAAAAABBCBDCDCCCBABABAxACAACDCBDCCBCxABDDCBDBCAACAADAABDBxACDBCCxDAABADDAxDCxxDCBAAxBAxBBDxBDCABCCDAACABBABDDAAAxCDDCxADDDAABAxBDACCAACxCCCCABAxCCDABCxAACCCDBCADxACDDADCxACDBBDCBDCABxCCCCADDCCBABxBBDAAxBxAxCACBBBCxCBxCCADBCCCCxDACBAxCxADAACDDDCBxCAAABAACCxCxBADxBBBBDBCxDCCBCDACDBxCDBxCBxAxADxACCxxAABBBxADCCxDDDDCABABBDxBxDxxDCADCAxAxACxDBxDBABAxCCxxCxDBBBBCDCBxxBAxxCxDCAxxABxDDxDADDCDDADDxCDCACCACBCADBBABCxBDxxxCDxBDCBxBBCxxDDDAxDDxxCDxBCxDxCCAADAxCCCADCBxxAxCDDBBBxAADCBxCAxACAAACBBBBDBxADDBxAxCAxxACDAxAABxxABCxAxBDDACxxABBBDABDDCBxACAxCCCBCCDDxADCDCxDxBABCxAABBxCCCxBAAxBABDBxBACAxDABxDDBxBCDABCCCxBAADCDABDDCxADxCCDADDCACxAxAxxBDBDxBDDBABACxBBBCDxBDBCDBBDDADCCDxBxDBDDDACDBADDADxxxADxxDAADABxDCBxAACAxBCDBAxCCCxBACxCCxCDAxACDBxAxDDCxDCBxxABBABCCxxBBxBCxBABxDAADCCADCABDDBBxBxBABAxBADDCBDDxxBBCxxxxDDDDCABBAxDACCDACBBBAxBBxxxAxABAxBCBABCxBBCxAAxDBDCDAxDDCxDxDxAACCABBACBCBCDDBABDxxxBxBAxBDxxxCxCxBDABDBADAxCxABAxBxAxCxxBABBAABBDDADAxCCAAABDAxxBCCBBxBABBCBDxxDxDAAxxACDBBDxBBDDCCBBAxBCxCxACABABxCBxxBCxxDDBxCxDBxBDCCCADACCAABCDBxCCCxCAxBCAABxBxxBCBBBAxAxDxxCBBDBCDABBDADxBxABABCxCAxDDxADCBxDCBBABDDCACDxxDxBxAxCDDABBCCxAAABDBCBDBCDBBCBxxDBABBBBDxBDxBxBBxBDxCBxDDCxBCCDDxDBAxBBCxBDCCDCBCxCAxBDADxDxCDxAADxxDCBADxABxxAACDDBCADBADxBCxBBBDBCBCCAAxADBDxxCDxxxDxxDxDDDBBDABAADxxDACxBCxxDACADxDBADBCCxBBCACCCACCBBAxBBCBxBCCABCxCBCDBCBxCDACxxDxABCxCAAxAxDxDABCxCBxBxxCxCxABDDDADxBBBBDDBDxAAxCBBAAADxBxCDxDBADBxBACxAxDABCADACDxDCAACxADAACDAxDCxADCxABxDADDABBADBCBCCCBDAxBCCCDABxAAAxCxBDBxABDBCBDCABxADBBABACxxxxABxAAxCBAABxCCxAABxDCDCBDCACCCBDAAxDxCCAxxBDxCABCDBxCCxCBDDxBBDxBxBADDCxDCDDBxDCAAABxBDxADCDCDABxxDAxCBxDxBCABCBCxDCDBABBADCAAAxCDCCCxDDBBxxCDAABxADDxxxBBBDDxCDABAxCDCxCBAAAABDDDBxCDCxDCCCCCDBAxCBxDDCxxACxDBDAxBBABDBABBDBDDDCxAAACCCxDxCCDxxAxBxDADCxDDCBACDAxDDBBBDDCBBBCAACCxDAAD")

(println 1     (potion-cost "xBx"))
(println 6     (potion-cost "AAA"))
(println 15    (potion-cost "BCD"))
(println 8     (potion-cost "xCC"))
(println 30    (potion-cost sample-input))
(println 27723 (potion-cost actual-input))
